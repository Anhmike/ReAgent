

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ml.rl.evaluation package &mdash; ReAgent 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="ml.rl.models package" href="ml.rl.models.html" />
    <link rel="prev" title="Continuous Integration" href="../continuous_integration.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> ReAgent
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rasp_tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced Topics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../distributed.html">Distributed Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../continuous_integration.html">Continuous Integration</a></li>
</ul>
<p class="caption"><span class="caption-text">Package Reference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Evaluation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-ml.rl.evaluation.cpe">ml.rl.evaluation.cpe module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-ml.rl.evaluation.doubly_robust_estimator">ml.rl.evaluation.doubly_robust_estimator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-ml.rl.evaluation.evaluation_data_page">ml.rl.evaluation.evaluation_data_page module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-ml.rl.evaluation.evaluator">ml.rl.evaluation.evaluator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-ml.rl.evaluation.ranking_evaluator">ml.rl.evaluation.ranking_evaluator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-ml.rl.evaluation.sequential_doubly_robust_estimator">ml.rl.evaluation.sequential_doubly_robust_estimator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-ml.rl.evaluation.weighted_sequential_doubly_robust_estimator">ml.rl.evaluation.weighted_sequential_doubly_robust_estimator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-ml.rl.evaluation.world_model_evaluator">ml.rl.evaluation.world_model_evaluator module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-ml.rl.evaluation">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ml.rl.models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="ml.rl.prediction.html">Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="ml.rl.preprocessing.html">Preprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="ml.rl.readers.html">Readers</a></li>
<li class="toctree-l1"><a class="reference internal" href="ml.rl.simulators.html">Simulators</a></li>
<li class="toctree-l1"><a class="reference internal" href="ml.rl.thrift.html">Thrift</a></li>
<li class="toctree-l1"><a class="reference internal" href="ml.rl.training.html">Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="ml.rl.workflow.html">Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">All Modules</a></li>
</ul>
<p class="caption"><span class="caption-text">Others</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/facebookresearch/ReAgent">Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">ReAgent</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>ml.rl.evaluation package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/ml.rl.evaluation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="ml-rl-evaluation-package">
<h1>ml.rl.evaluation package<a class="headerlink" href="#ml-rl-evaluation-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-ml.rl.evaluation.cpe">
<span id="ml-rl-evaluation-cpe-module"></span><h2>ml.rl.evaluation.cpe module<a class="headerlink" href="#module-ml.rl.evaluation.cpe" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ml.rl.evaluation.cpe.CpeDetails">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.cpe.</code><code class="sig-name descname">CpeDetails</code><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeDetails" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="ml.rl.evaluation.cpe.CpeDetails.log">
<code class="sig-name descname">log</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeDetails.log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.cpe.CpeDetails.log_to_tensorboard">
<code class="sig-name descname">log_to_tensorboard</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#ml.rl.evaluation.cpe.CpeDetails.log_to_tensorboard" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ml.rl.evaluation.cpe.CpeEstimate">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.cpe.</code><code class="sig-name descname">CpeEstimate</code><span class="sig-paren">(</span><em class="sig-param">raw</em>, <em class="sig-param">normalized</em>, <em class="sig-param">raw_std_error</em>, <em class="sig-param">normalized_std_error</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeEstimate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="method">
<dt id="ml.rl.evaluation.cpe.CpeEstimate.normalized">
<em class="property">property </em><code class="sig-name descname">normalized</code><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeEstimate.normalized" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.cpe.CpeEstimate.normalized_std_error">
<em class="property">property </em><code class="sig-name descname">normalized_std_error</code><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeEstimate.normalized_std_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.cpe.CpeEstimate.raw">
<em class="property">property </em><code class="sig-name descname">raw</code><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeEstimate.raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.cpe.CpeEstimate.raw_std_error">
<em class="property">property </em><code class="sig-name descname">raw_std_error</code><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeEstimate.raw_std_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ml.rl.evaluation.cpe.CpeEstimateSet">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.cpe.</code><code class="sig-name descname">CpeEstimateSet</code><span class="sig-paren">(</span><em class="sig-param">direct_method</em>, <em class="sig-param">inverse_propensity</em>, <em class="sig-param">doubly_robust</em>, <em class="sig-param">sequential_doubly_robust</em>, <em class="sig-param">weighted_doubly_robust</em>, <em class="sig-param">magic</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeEstimateSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="method">
<dt id="ml.rl.evaluation.cpe.CpeEstimateSet.check_estimates_exist">
<code class="sig-name descname">check_estimates_exist</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeEstimateSet.check_estimates_exist" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.cpe.CpeEstimateSet.direct_method">
<em class="property">property </em><code class="sig-name descname">direct_method</code><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeEstimateSet.direct_method" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.cpe.CpeEstimateSet.doubly_robust">
<em class="property">property </em><code class="sig-name descname">doubly_robust</code><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeEstimateSet.doubly_robust" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.cpe.CpeEstimateSet.fill_empty_with_zero">
<code class="sig-name descname">fill_empty_with_zero</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeEstimateSet.fill_empty_with_zero" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.cpe.CpeEstimateSet.inverse_propensity">
<em class="property">property </em><code class="sig-name descname">inverse_propensity</code><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeEstimateSet.inverse_propensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.cpe.CpeEstimateSet.log">
<code class="sig-name descname">log</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeEstimateSet.log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.cpe.CpeEstimateSet.log_to_tensorboard">
<code class="sig-name descname">log_to_tensorboard</code><span class="sig-paren">(</span><em class="sig-param">metric_name: str</em><span class="sig-paren">)</span> &#x2192; None<a class="headerlink" href="#ml.rl.evaluation.cpe.CpeEstimateSet.log_to_tensorboard" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.cpe.CpeEstimateSet.magic">
<em class="property">property </em><code class="sig-name descname">magic</code><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeEstimateSet.magic" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.cpe.CpeEstimateSet.sequential_doubly_robust">
<em class="property">property </em><code class="sig-name descname">sequential_doubly_robust</code><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeEstimateSet.sequential_doubly_robust" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.cpe.CpeEstimateSet.weighted_doubly_robust">
<em class="property">property </em><code class="sig-name descname">weighted_doubly_robust</code><a class="headerlink" href="#ml.rl.evaluation.cpe.CpeEstimateSet.weighted_doubly_robust" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ml.rl.evaluation.cpe.bootstrapped_std_error_of_mean">
<code class="sig-prename descclassname">ml.rl.evaluation.cpe.</code><code class="sig-name descname">bootstrapped_std_error_of_mean</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">sample_percent=0.25</em>, <em class="sig-param">num_samples=1000</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.cpe.bootstrapped_std_error_of_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute bootstrapped standard error of mean of input data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – Input data (1D torch tensor or numpy array).</p></li>
<li><p><strong>sample_percent</strong> – Size of sample to use to calculate bootstrap statistic.</p></li>
<li><p><strong>num_samples</strong> – Number of times to sample.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-ml.rl.evaluation.doubly_robust_estimator">
<span id="ml-rl-evaluation-doubly-robust-estimator-module"></span><h2>ml.rl.evaluation.doubly_robust_estimator module<a class="headerlink" href="#module-ml.rl.evaluation.doubly_robust_estimator" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimator">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.doubly_robust_estimator.</code><code class="sig-name descname">DoublyRobustEstimator</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>For details, visit <a class="reference external" href="https://arxiv.org/pdf/1612.01205.pdf">https://arxiv.org/pdf/1612.01205.pdf</a></p>
<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimator.estimate">
<code class="sig-name descname">estimate</code><span class="sig-paren">(</span><em class="sig-param">edp: ml.rl.evaluation.evaluation_data_page.EvaluationDataPage</em>, <em class="sig-param">hp: Optional[dict] = None</em><span class="sig-paren">)</span> &#x2192; Tuple[ml.rl.evaluation.cpe.CpeEstimate, ml.rl.evaluation.cpe.CpeEstimate, ml.rl.evaluation.cpe.CpeEstimate]<a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimator.estimate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimatorBOPE">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.doubly_robust_estimator.</code><code class="sig-name descname">DoublyRobustEstimatorBOPE</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimatorBOPE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimator" title="ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimator</span></code></a></p>
<p>This class implements a doubly-robust Balanced Off-Policy Evaluation (BOP-E)
method.
For details about BOP-E see <a class="reference external" href="https://arxiv.org/abs/1906.03694">https://arxiv.org/abs/1906.03694</a>
For analysis of BOP-E performance see <a class="reference external" href="https://fburl.com/bope_eval_nb">https://fburl.com/bope_eval_nb</a></p>
<p>Note that when using BOP-E the data gets split into training, validation
and evaluation parts and only the evaluation part is used directly for policy
evaluation, while training and validation datasets are used for model training.</p>
<p>supported modes (all doubly robust):
1. bope_weights. Use BOP-E (ignoring logged propensities) to estimate the</p>
<blockquote>
<div><p>importance weights. Propensities of the target policy are used as
observation weights when training BOP-E classifier.</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><dl class="simple">
<dt>bope_weighted_targets. Use BOP-E (ignoring logged propensities) to</dt><dd><p>estimate the importance weights. Propensities of the target policy
are used as soft targets to train BOP-E regressor. With this method
BOP-E trains a regressor instead of a classifier.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>bope_sampling. Use BOP-E (ignoring logged propensities)</dt><dd><p>to estimate the importance weights. Propensities of the target policy
are used to sample the actions for the classifier training data.</p>
</dd>
</dl>
</li>
</ol>
<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimatorBOPE.estimate">
<code class="sig-name descname">estimate</code><span class="sig-paren">(</span><em class="sig-param">edp: ml.rl.evaluation.evaluation_data_page.EvaluationDataPage</em>, <em class="sig-param">hp: Optional[dict] = None</em><span class="sig-paren">)</span> &#x2192; Tuple[ml.rl.evaluation.cpe.CpeEstimate, ml.rl.evaluation.cpe.CpeEstimate, ml.rl.evaluation.cpe.CpeEstimate]<a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimatorBOPE.estimate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimatorEstProp">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.doubly_robust_estimator.</code><code class="sig-name descname">DoublyRobustEstimatorEstProp</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimatorEstProp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimator" title="ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimator"><code class="xref py py-class docutils literal notranslate"><span class="pre">ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimator</span></code></a></p>
<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimatorEstProp.estimate">
<code class="sig-name descname">estimate</code><span class="sig-paren">(</span><em class="sig-param">edp: ml.rl.evaluation.evaluation_data_page.EvaluationDataPage</em>, <em class="sig-param">hp: Optional[dict] = None</em><span class="sig-paren">)</span> &#x2192; Tuple[ml.rl.evaluation.cpe.CpeEstimate, ml.rl.evaluation.cpe.CpeEstimate, ml.rl.evaluation.cpe.CpeEstimate]<a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.DoublyRobustEstimatorEstProp.estimate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.doubly_robust_estimator.</code><code class="sig-name descname">EstimationData</code><span class="sig-paren">(</span><em class="sig-param">contexts_actions_train</em>, <em class="sig-param">policy_indicators_train</em>, <em class="sig-param">weights_train</em>, <em class="sig-param">contexts_actions_valid</em>, <em class="sig-param">policy_indicators_valid</em>, <em class="sig-param">weights_valid</em>, <em class="sig-param">contexts_actions_eval</em>, <em class="sig-param">contexts_train</em>, <em class="sig-param">actions_logged_train</em>, <em class="sig-param">contexts_valid</em>, <em class="sig-param">actions_logged_valid</em>, <em class="sig-param">contexts_eval</em>, <em class="sig-param">actions_logged_eval</em>, <em class="sig-param">model_propensities_eval</em>, <em class="sig-param">model_rewards_eval</em>, <em class="sig-param">action_mask_eval</em>, <em class="sig-param">logged_rewards_eval</em>, <em class="sig-param">model_rewards_for_logged_action_eval</em>, <em class="sig-param">logged_propensities_eval</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.action_mask_eval">
<em class="property">property </em><code class="sig-name descname">action_mask_eval</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.action_mask_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 15</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.actions_logged_eval">
<em class="property">property </em><code class="sig-name descname">actions_logged_eval</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.actions_logged_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 12</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.actions_logged_train">
<em class="property">property </em><code class="sig-name descname">actions_logged_train</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.actions_logged_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 8</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.actions_logged_valid">
<em class="property">property </em><code class="sig-name descname">actions_logged_valid</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.actions_logged_valid" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 10</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.contexts_actions_eval">
<em class="property">property </em><code class="sig-name descname">contexts_actions_eval</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.contexts_actions_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.contexts_actions_train">
<em class="property">property </em><code class="sig-name descname">contexts_actions_train</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.contexts_actions_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.contexts_actions_valid">
<em class="property">property </em><code class="sig-name descname">contexts_actions_valid</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.contexts_actions_valid" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.contexts_eval">
<em class="property">property </em><code class="sig-name descname">contexts_eval</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.contexts_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 11</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.contexts_train">
<em class="property">property </em><code class="sig-name descname">contexts_train</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.contexts_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.contexts_valid">
<em class="property">property </em><code class="sig-name descname">contexts_valid</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.contexts_valid" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 9</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.logged_propensities_eval">
<em class="property">property </em><code class="sig-name descname">logged_propensities_eval</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.logged_propensities_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 18</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.logged_rewards_eval">
<em class="property">property </em><code class="sig-name descname">logged_rewards_eval</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.logged_rewards_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 16</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.model_propensities_eval">
<em class="property">property </em><code class="sig-name descname">model_propensities_eval</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.model_propensities_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 13</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.model_rewards_eval">
<em class="property">property </em><code class="sig-name descname">model_rewards_eval</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.model_rewards_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 14</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.model_rewards_for_logged_action_eval">
<em class="property">property </em><code class="sig-name descname">model_rewards_for_logged_action_eval</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.model_rewards_for_logged_action_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 17</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.policy_indicators_train">
<em class="property">property </em><code class="sig-name descname">policy_indicators_train</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.policy_indicators_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.policy_indicators_valid">
<em class="property">property </em><code class="sig-name descname">policy_indicators_valid</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.policy_indicators_valid" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.weights_train">
<em class="property">property </em><code class="sig-name descname">weights_train</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.weights_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.EstimationData.weights_valid">
<em class="property">property </em><code class="sig-name descname">weights_valid</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.EstimationData.weights_valid" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ml.rl.evaluation.doubly_robust_estimator.ImportanceSamplingData">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.doubly_robust_estimator.</code><code class="sig-name descname">ImportanceSamplingData</code><span class="sig-paren">(</span><em class="sig-param">importance_weight</em>, <em class="sig-param">logged_rewards</em>, <em class="sig-param">model_rewards</em>, <em class="sig-param">model_rewards_for_logged_action</em>, <em class="sig-param">model_propensities</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.ImportanceSamplingData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.ImportanceSamplingData.importance_weight">
<em class="property">property </em><code class="sig-name descname">importance_weight</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.ImportanceSamplingData.importance_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.ImportanceSamplingData.logged_rewards">
<em class="property">property </em><code class="sig-name descname">logged_rewards</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.ImportanceSamplingData.logged_rewards" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.ImportanceSamplingData.model_propensities">
<em class="property">property </em><code class="sig-name descname">model_propensities</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.ImportanceSamplingData.model_propensities" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.ImportanceSamplingData.model_rewards">
<em class="property">property </em><code class="sig-name descname">model_rewards</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.ImportanceSamplingData.model_rewards" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.ImportanceSamplingData.model_rewards_for_logged_action">
<em class="property">property </em><code class="sig-name descname">model_rewards_for_logged_action</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.ImportanceSamplingData.model_rewards_for_logged_action" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.doubly_robust_estimator.</code><code class="sig-name descname">TrainValidEvalData</code><span class="sig-paren">(</span><em class="sig-param">contexts_dict</em>, <em class="sig-param">model_propensities_dict</em>, <em class="sig-param">actions_logged_dict</em>, <em class="sig-param">action_mask_dict</em>, <em class="sig-param">logged_rewards_dict</em>, <em class="sig-param">model_rewards_dict</em>, <em class="sig-param">model_rewards_for_logged_action_dict</em>, <em class="sig-param">logged_propensities_dict</em>, <em class="sig-param">num_examples_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.action_mask_dict">
<em class="property">property </em><code class="sig-name descname">action_mask_dict</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.action_mask_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.actions_logged_dict">
<em class="property">property </em><code class="sig-name descname">actions_logged_dict</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.actions_logged_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.contexts_dict">
<em class="property">property </em><code class="sig-name descname">contexts_dict</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.contexts_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.logged_propensities_dict">
<em class="property">property </em><code class="sig-name descname">logged_propensities_dict</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.logged_propensities_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.logged_rewards_dict">
<em class="property">property </em><code class="sig-name descname">logged_rewards_dict</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.logged_rewards_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.model_propensities_dict">
<em class="property">property </em><code class="sig-name descname">model_propensities_dict</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.model_propensities_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.model_rewards_dict">
<em class="property">property </em><code class="sig-name descname">model_rewards_dict</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.model_rewards_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.model_rewards_for_logged_action_dict">
<em class="property">property </em><code class="sig-name descname">model_rewards_for_logged_action_dict</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.model_rewards_for_logged_action_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.num_examples_dict">
<em class="property">property </em><code class="sig-name descname">num_examples_dict</code><a class="headerlink" href="#ml.rl.evaluation.doubly_robust_estimator.TrainValidEvalData.num_examples_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 8</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-ml.rl.evaluation.evaluation_data_page">
<span id="ml-rl-evaluation-evaluation-data-page-module"></span><h2>ml.rl.evaluation.evaluation_data_page module<a class="headerlink" href="#module-ml.rl.evaluation.evaluation_data_page" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.evaluation_data_page.</code><code class="sig-name descname">EvaluationDataPage</code><span class="sig-paren">(</span><em class="sig-param">mdp_id</em>, <em class="sig-param">sequence_number</em>, <em class="sig-param">logged_propensities</em>, <em class="sig-param">logged_rewards</em>, <em class="sig-param">action_mask</em>, <em class="sig-param">model_propensities</em>, <em class="sig-param">model_rewards</em>, <em class="sig-param">model_rewards_for_logged_action</em>, <em class="sig-param">model_values</em>, <em class="sig-param">model_values_for_logged_action</em>, <em class="sig-param">possible_actions_mask</em>, <em class="sig-param">optimal_q_values</em>, <em class="sig-param">eval_action_idxs</em>, <em class="sig-param">logged_values</em>, <em class="sig-param">logged_metrics</em>, <em class="sig-param">logged_metrics_values</em>, <em class="sig-param">model_metrics</em>, <em class="sig-param">model_metrics_for_logged_action</em>, <em class="sig-param">model_metrics_values</em>, <em class="sig-param">model_metrics_values_for_logged_action</em>, <em class="sig-param">possible_actions_state_concat</em>, <em class="sig-param">contexts</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.action_mask">
<em class="property">property </em><code class="sig-name descname">action_mask</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.action_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.append">
<code class="sig-name descname">append</code><span class="sig-paren">(</span><em class="sig-param">edp</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.append" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.compute_values">
<code class="sig-name descname">compute_values</code><span class="sig-paren">(</span><em class="sig-param">gamma: float</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.compute_values" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.compute_values_for_mdps">
<em class="property">static </em><code class="sig-name descname">compute_values_for_mdps</code><span class="sig-paren">(</span><em class="sig-param">rewards: torch.Tensor</em>, <em class="sig-param">mdp_ids: numpy.ndarray</em>, <em class="sig-param">sequence_numbers: torch.Tensor</em>, <em class="sig-param">gamma: float</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.compute_values_for_mdps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.contexts">
<em class="property">property </em><code class="sig-name descname">contexts</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.contexts" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 21</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.create_from_tensors_dqn">
<em class="property">classmethod </em><code class="sig-name descname">create_from_tensors_dqn</code><span class="sig-paren">(</span><em class="sig-param">trainer: ml.rl.training.dqn_trainer.DQNTrainer</em>, <em class="sig-param">mdp_ids: numpy.ndarray</em>, <em class="sig-param">sequence_numbers: torch.Tensor</em>, <em class="sig-param">states: ml.rl.types.PreprocessedFeatureVector</em>, <em class="sig-param">actions: ml.rl.types.PreprocessedFeatureVector</em>, <em class="sig-param">propensities: torch.Tensor</em>, <em class="sig-param">rewards: torch.Tensor</em>, <em class="sig-param">possible_actions_mask: torch.Tensor</em>, <em class="sig-param">metrics: Optional[torch.Tensor] = None</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.create_from_tensors_dqn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.create_from_tensors_parametric_dqn">
<em class="property">classmethod </em><code class="sig-name descname">create_from_tensors_parametric_dqn</code><span class="sig-paren">(</span><em class="sig-param">trainer: ml.rl.training.parametric_dqn_trainer.ParametricDQNTrainer</em>, <em class="sig-param">mdp_ids: numpy.ndarray</em>, <em class="sig-param">sequence_numbers: torch.Tensor</em>, <em class="sig-param">states: ml.rl.types.PreprocessedFeatureVector</em>, <em class="sig-param">actions: ml.rl.types.PreprocessedFeatureVector</em>, <em class="sig-param">propensities: torch.Tensor</em>, <em class="sig-param">rewards: torch.Tensor</em>, <em class="sig-param">possible_actions_mask: torch.Tensor</em>, <em class="sig-param">possible_actions: ml.rl.types.PreprocessedFeatureVector</em>, <em class="sig-param">max_num_actions: int</em>, <em class="sig-param">metrics: Optional[torch.Tensor] = None</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.create_from_tensors_parametric_dqn" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.create_from_training_batch">
<em class="property">classmethod </em><code class="sig-name descname">create_from_training_batch</code><span class="sig-paren">(</span><em class="sig-param">tdb: ml.rl.types.PreprocessedTrainingBatch</em>, <em class="sig-param">trainer: ml.rl.training.dqn_trainer.DQNTrainer</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.create_from_training_batch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.eval_action_idxs">
<em class="property">property </em><code class="sig-name descname">eval_action_idxs</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.eval_action_idxs" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 12</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.logged_metrics">
<em class="property">property </em><code class="sig-name descname">logged_metrics</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.logged_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 14</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.logged_metrics_values">
<em class="property">property </em><code class="sig-name descname">logged_metrics_values</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.logged_metrics_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 15</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.logged_propensities">
<em class="property">property </em><code class="sig-name descname">logged_propensities</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.logged_propensities" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.logged_rewards">
<em class="property">property </em><code class="sig-name descname">logged_rewards</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.logged_rewards" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.logged_values">
<em class="property">property </em><code class="sig-name descname">logged_values</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.logged_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 13</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.mdp_id">
<em class="property">property </em><code class="sig-name descname">mdp_id</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.mdp_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_metrics">
<em class="property">property </em><code class="sig-name descname">model_metrics</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 16</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_metrics_for_logged_action">
<em class="property">property </em><code class="sig-name descname">model_metrics_for_logged_action</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_metrics_for_logged_action" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 17</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_metrics_values">
<em class="property">property </em><code class="sig-name descname">model_metrics_values</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_metrics_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 18</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_metrics_values_for_logged_action">
<em class="property">property </em><code class="sig-name descname">model_metrics_values_for_logged_action</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_metrics_values_for_logged_action" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 19</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_propensities">
<em class="property">property </em><code class="sig-name descname">model_propensities</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_propensities" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_rewards">
<em class="property">property </em><code class="sig-name descname">model_rewards</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_rewards" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_rewards_for_logged_action">
<em class="property">property </em><code class="sig-name descname">model_rewards_for_logged_action</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_rewards_for_logged_action" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_values">
<em class="property">property </em><code class="sig-name descname">model_values</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 8</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_values_for_logged_action">
<em class="property">property </em><code class="sig-name descname">model_values_for_logged_action</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.model_values_for_logged_action" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 9</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.optimal_q_values">
<em class="property">property </em><code class="sig-name descname">optimal_q_values</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.optimal_q_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 11</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.possible_actions_mask">
<em class="property">property </em><code class="sig-name descname">possible_actions_mask</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.possible_actions_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 10</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.possible_actions_state_concat">
<em class="property">property </em><code class="sig-name descname">possible_actions_state_concat</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.possible_actions_state_concat" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 20</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.sequence_number">
<em class="property">property </em><code class="sig-name descname">sequence_number</code><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.sequence_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.set_metric_as_reward">
<code class="sig-name descname">set_metric_as_reward</code><span class="sig-paren">(</span><em class="sig-param">i: int</em>, <em class="sig-param">num_actions: int</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.set_metric_as_reward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.sort">
<code class="sig-name descname">sort</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.sort" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.evaluation_data_page.EvaluationDataPage.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-ml.rl.evaluation.evaluator">
<span id="ml-rl-evaluation-evaluator-module"></span><h2>ml.rl.evaluation.evaluator module<a class="headerlink" href="#module-ml.rl.evaluation.evaluator" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ml.rl.evaluation.evaluator.Evaluator">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.evaluator.</code><code class="sig-name descname">Evaluator</code><span class="sig-paren">(</span><em class="sig-param">action_names</em>, <em class="sig-param">gamma</em>, <em class="sig-param">model</em>, <em class="sig-param">metrics_to_score=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.evaluator.Evaluator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="attribute">
<dt id="ml.rl.evaluation.evaluator.Evaluator.NUM_J_STEPS_FOR_MAGIC_ESTIMATOR">
<code class="sig-name descname">NUM_J_STEPS_FOR_MAGIC_ESTIMATOR</code><em class="property"> = 25</em><a class="headerlink" href="#ml.rl.evaluation.evaluator.Evaluator.NUM_J_STEPS_FOR_MAGIC_ESTIMATOR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluator.Evaluator.evaluate_post_training">
<code class="sig-name descname">evaluate_post_training</code><span class="sig-paren">(</span><em class="sig-param">edp: ml.rl.evaluation.evaluation_data_page.EvaluationDataPage</em><span class="sig-paren">)</span> &#x2192; ml.rl.evaluation.cpe.CpeDetails<a class="headerlink" href="#ml.rl.evaluation.evaluator.Evaluator.evaluate_post_training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluator.Evaluator.get_target_distribution_error">
<code class="sig-name descname">get_target_distribution_error</code><span class="sig-paren">(</span><em class="sig-param">actions</em>, <em class="sig-param">target_distribution</em>, <em class="sig-param">actual_distribution</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.evaluator.Evaluator.get_target_distribution_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate MSE between actual and target action distribution.</p>
</dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluator.Evaluator.huberLoss">
<em class="property">static </em><code class="sig-name descname">huberLoss</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">output</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.evaluator.Evaluator.huberLoss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.evaluator.Evaluator.score_cpe">
<code class="sig-name descname">score_cpe</code><span class="sig-paren">(</span><em class="sig-param">metric_name</em>, <em class="sig-param">edp: ml.rl.evaluation.evaluation_data_page.EvaluationDataPage</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.evaluator.Evaluator.score_cpe" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="ml.rl.evaluation.evaluator.get_metrics_to_score">
<code class="sig-prename descclassname">ml.rl.evaluation.evaluator.</code><code class="sig-name descname">get_metrics_to_score</code><span class="sig-paren">(</span><em class="sig-param">metric_reward_values: Optional[Dict[str, float]]</em><span class="sig-paren">)</span> &#x2192; List[str]<a class="headerlink" href="#ml.rl.evaluation.evaluator.get_metrics_to_score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ml.rl.evaluation.evaluator.get_tensor">
<code class="sig-prename descclassname">ml.rl.evaluation.evaluator.</code><code class="sig-name descname">get_tensor</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">dtype=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.evaluator.get_tensor" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Input:</dt><dd><ul class="simple">
<li><p>x: list or a sequence</p></li>
<li><dl class="simple">
<dt>dtype: target data type of the elements in tensor [optional]</dt><dd><p>It will be inferred automatically if not provided.</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Output:</dt><dd><p>Tensor given a list or a sequence.
If the input is None, it returns None
If the input is a tensor it returns the tensor.
If type is provides the output Tensor will have that type</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-ml.rl.evaluation.ranking_evaluator">
<span id="ml-rl-evaluation-ranking-evaluator-module"></span><h2>ml.rl.evaluation.ranking_evaluator module<a class="headerlink" href="#module-ml.rl.evaluation.ranking_evaluator" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ml.rl.evaluation.ranking_evaluator.RankingEvaluator">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.ranking_evaluator.</code><code class="sig-name descname">RankingEvaluator</code><span class="sig-paren">(</span><em class="sig-param">trainer: ml.rl.training.ranking.seq2slate_trainer.Seq2SlateTrainer</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.ranking_evaluator.RankingEvaluator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Evaluate ranking models</p>
<dl class="method">
<dt id="ml.rl.evaluation.ranking_evaluator.RankingEvaluator.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param">eval_tdp: ml.rl.types.PreprocessedTrainingBatch</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.ranking_evaluator.RankingEvaluator.evaluate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.ranking_evaluator.RankingEvaluator.evaluate_post_training">
<code class="sig-name descname">evaluate_post_training</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.ranking_evaluator.RankingEvaluator.evaluate_post_training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-ml.rl.evaluation.sequential_doubly_robust_estimator">
<span id="ml-rl-evaluation-sequential-doubly-robust-estimator-module"></span><h2>ml.rl.evaluation.sequential_doubly_robust_estimator module<a class="headerlink" href="#module-ml.rl.evaluation.sequential_doubly_robust_estimator" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ml.rl.evaluation.sequential_doubly_robust_estimator.SequentialDoublyRobustEstimator">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.sequential_doubly_robust_estimator.</code><code class="sig-name descname">SequentialDoublyRobustEstimator</code><span class="sig-paren">(</span><em class="sig-param">gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.sequential_doubly_robust_estimator.SequentialDoublyRobustEstimator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="ml.rl.evaluation.sequential_doubly_robust_estimator.SequentialDoublyRobustEstimator.estimate">
<code class="sig-name descname">estimate</code><span class="sig-paren">(</span><em class="sig-param">edp: ml.rl.evaluation.evaluation_data_page.EvaluationDataPage</em><span class="sig-paren">)</span> &#x2192; ml.rl.evaluation.cpe.CpeEstimate<a class="headerlink" href="#ml.rl.evaluation.sequential_doubly_robust_estimator.SequentialDoublyRobustEstimator.estimate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-ml.rl.evaluation.weighted_sequential_doubly_robust_estimator">
<span id="ml-rl-evaluation-weighted-sequential-doubly-robust-estimator-module"></span><h2>ml.rl.evaluation.weighted_sequential_doubly_robust_estimator module<a class="headerlink" href="#module-ml.rl.evaluation.weighted_sequential_doubly_robust_estimator" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.</code><code class="sig-name descname">WeightedSequentialDoublyRobustEstimator</code><span class="sig-paren">(</span><em class="sig-param">gamma</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="attribute">
<dt id="ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.BOOTSTRAP_SAMPLE_PCT">
<code class="sig-name descname">BOOTSTRAP_SAMPLE_PCT</code><em class="property"> = 0.5</em><a class="headerlink" href="#ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.BOOTSTRAP_SAMPLE_PCT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.CONFIDENCE_INTERVAL">
<code class="sig-name descname">CONFIDENCE_INTERVAL</code><em class="property"> = 0.9</em><a class="headerlink" href="#ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.CONFIDENCE_INTERVAL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.NUM_BOOTSTRAP_SAMPLES">
<code class="sig-name descname">NUM_BOOTSTRAP_SAMPLES</code><em class="property"> = 50</em><a class="headerlink" href="#ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.NUM_BOOTSTRAP_SAMPLES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.NUM_SUBSETS_FOR_CB_ESTIMATES">
<code class="sig-name descname">NUM_SUBSETS_FOR_CB_ESTIMATES</code><em class="property"> = 25</em><a class="headerlink" href="#ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.NUM_SUBSETS_FOR_CB_ESTIMATES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.calculate_step_return">
<em class="property">static </em><code class="sig-name descname">calculate_step_return</code><span class="sig-paren">(</span><em class="sig-param">rewards</em>, <em class="sig-param">discounts</em>, <em class="sig-param">importance_weights</em>, <em class="sig-param">importance_weights_one_earlier</em>, <em class="sig-param">estimated_state_values</em>, <em class="sig-param">estimated_q_values</em>, <em class="sig-param">j_step</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.calculate_step_return" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.compute_weighted_doubly_robust_point_estimate">
<code class="sig-name descname">compute_weighted_doubly_robust_point_estimate</code><span class="sig-paren">(</span><em class="sig-param">j_steps</em>, <em class="sig-param">num_j_steps</em>, <em class="sig-param">j_step_returns</em>, <em class="sig-param">infinite_step_returns</em>, <em class="sig-param">j_step_return_trajectories</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.compute_weighted_doubly_robust_point_estimate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.confidence_bounds">
<em class="property">static </em><code class="sig-name descname">confidence_bounds</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">confidence</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.confidence_bounds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.estimate">
<code class="sig-name descname">estimate</code><span class="sig-paren">(</span><em class="sig-param">edp: ml.rl.evaluation.evaluation_data_page.EvaluationDataPage</em>, <em class="sig-param">num_j_steps</em>, <em class="sig-param">whether_self_normalize_importance_weights</em><span class="sig-paren">)</span> &#x2192; ml.rl.evaluation.cpe.CpeEstimate<a class="headerlink" href="#ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.estimate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.normalize_importance_weights">
<em class="property">static </em><code class="sig-name descname">normalize_importance_weights</code><span class="sig-paren">(</span><em class="sig-param">importance_weights</em>, <em class="sig-param">whether_self_normalize_importance_weights</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.normalize_importance_weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.transform_to_equal_length_trajectories">
<em class="property">static </em><code class="sig-name descname">transform_to_equal_length_trajectories</code><span class="sig-paren">(</span><em class="sig-param">mdp_ids</em>, <em class="sig-param">actions</em>, <em class="sig-param">rewards</em>, <em class="sig-param">logged_propensities</em>, <em class="sig-param">target_propensities</em>, <em class="sig-param">estimated_q_values</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.WeightedSequentialDoublyRobustEstimator.transform_to_equal_length_trajectories" title="Permalink to this definition">¶</a></dt>
<dd><p>Take in samples (action, rewards, propensities, etc.) and output lists
of equal-length trajectories (episodes) according to terminals.
As the raw trajectories are of various lengths, the shorter ones are
filled with zeros(ones) at the end.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.mse_loss">
<code class="sig-prename descclassname">ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.</code><code class="sig-name descname">mse_loss</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">error</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.weighted_sequential_doubly_robust_estimator.mse_loss" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-ml.rl.evaluation.world_model_evaluator">
<span id="ml-rl-evaluation-world-model-evaluator-module"></span><h2>ml.rl.evaluation.world_model_evaluator module<a class="headerlink" href="#module-ml.rl.evaluation.world_model_evaluator" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ml.rl.evaluation.world_model_evaluator.FeatureImportanceEvaluator">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.world_model_evaluator.</code><code class="sig-name descname">FeatureImportanceEvaluator</code><span class="sig-paren">(</span><em class="sig-param">trainer: ml.rl.training.world_model.mdnrnn_trainer.MDNRNNTrainer, discrete_action: bool, state_feature_num: int, action_feature_num: int, sorted_action_feature_start_indices: List[int], sorted_state_feature_start_indices: List[int]</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.world_model_evaluator.FeatureImportanceEvaluator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Evaluate feature importance weights on data pages</p>
<dl class="method">
<dt id="ml.rl.evaluation.world_model_evaluator.FeatureImportanceEvaluator.compute_median_feature_value">
<code class="sig-name descname">compute_median_feature_value</code><span class="sig-paren">(</span><em class="sig-param">features</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.world_model_evaluator.FeatureImportanceEvaluator.compute_median_feature_value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ml.rl.evaluation.world_model_evaluator.FeatureImportanceEvaluator.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param">tdp: ml.rl.types.PreprocessedTrainingBatch</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.world_model_evaluator.FeatureImportanceEvaluator.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate feature importance: setting each state/action feature to
the mean value and observe loss increase.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ml.rl.evaluation.world_model_evaluator.FeatureSensitivityEvaluator">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.world_model_evaluator.</code><code class="sig-name descname">FeatureSensitivityEvaluator</code><span class="sig-paren">(</span><em class="sig-param">trainer: ml.rl.training.world_model.mdnrnn_trainer.MDNRNNTrainer, state_feature_num: int, sorted_state_feature_start_indices: List[int]</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.world_model_evaluator.FeatureSensitivityEvaluator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Evaluate state feature sensitivity caused by varying actions</p>
<dl class="method">
<dt id="ml.rl.evaluation.world_model_evaluator.FeatureSensitivityEvaluator.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param">tdp: ml.rl.types.PreprocessedTrainingBatch</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.world_model_evaluator.FeatureSensitivityEvaluator.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate state feature sensitivity due to actions:
randomly permutating actions and see how much the prediction of next
state feature deviates.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ml.rl.evaluation.world_model_evaluator.LossEvaluator">
<em class="property">class </em><code class="sig-prename descclassname">ml.rl.evaluation.world_model_evaluator.</code><code class="sig-name descname">LossEvaluator</code><span class="sig-paren">(</span><em class="sig-param">trainer: ml.rl.training.world_model.mdnrnn_trainer.MDNRNNTrainer</em>, <em class="sig-param">state_dim: int</em><span class="sig-paren">)</span><a class="headerlink" href="#ml.rl.evaluation.world_model_evaluator.LossEvaluator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Evaluate losses on data pages</p>
<dl class="method">
<dt id="ml.rl.evaluation.world_model_evaluator.LossEvaluator.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param">tdp: ml.rl.types.PreprocessedTrainingBatch</em><span class="sig-paren">)</span> &#x2192; Dict<a class="headerlink" href="#ml.rl.evaluation.world_model_evaluator.LossEvaluator.evaluate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-ml.rl.evaluation">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-ml.rl.evaluation" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ml.rl.models.html" class="btn btn-neutral float-right" title="ml.rl.models package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../continuous_integration.html" class="btn btn-neutral float-left" title="Continuous Integration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Facebook Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>